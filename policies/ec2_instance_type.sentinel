# Import the tfplan/v2 import to access the Terraform plan data.
import "tfplan/v2" as tfplan

# Define a rule to check if the instance type is t3.micro.
instance_type_rule = rule {
  all tfplan.resource_changes as _, rc {
    rc.type is "aws_instance" and
    rc.change.after.instance_type is "t3.micro"
  }
}

# Define the main rule to enforce the instance type rule.
main = rule {
  instance_type_rule
}