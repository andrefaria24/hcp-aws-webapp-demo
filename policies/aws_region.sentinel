import "tfplan"

# Define the allowed region
allowed_region = "us-east-2"

# Get all the resources in the plan
all_resources = tfplan.module_paths

# Iterate over all resources and check their region
main = rule {
    all_resources.all as resource {
        resource_config = tfplan.module(resource).config
        resource_config.region is allowed_region
    }
}